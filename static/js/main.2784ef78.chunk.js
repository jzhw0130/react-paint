(this["webpackJsonpreact-paint"]=this["webpackJsonpreact-paint"]||[]).push([[0],{106:function(e,t,a){},108:function(e,t,a){},110:function(e,t,a){},111:function(e,t,a){},112:function(e,t,a){},120:function(e,t,a){},121:function(e,t,a){"use strict";a.r(t);var c,s,i,n,o,l=a(0),r=a(10),u=a.n(r),h=a(15),v=(a(98),a(67)),p=a.n(v),O=a(72),j=a.n(O),b=a(73),x=a.n(b);!function(e){e[e.PEN=0]="PEN",e[e.COLOR_FILL=1]="COLOR_FILL",e[e.TEXT=2]="TEXT",e[e.COLOR_EXTRACT=3]="COLOR_EXTRACT",e[e.ERASER=4]="ERASER",e[e.MAGNIFYING=5]="MAGNIFYING",e[e.SHAPE=6]="SHAPE"}(c||(c={})),function(e){e[e.LINE=0]="LINE",e[e.RECT=1]="RECT",e[e.CIRCLE=2]="CIRCLE",e[e.RHOMBUS=3]="RHOMBUS",e[e.TRIANGLE=4]="TRIANGLE",e[e.PENTAGON=5]="PENTAGON",e[e.SEXANGLE=6]="SEXANGLE",e[e.ARROW_TOP=7]="ARROW_TOP",e[e.ARROW_RIGHT=8]="ARROW_RIGHT",e[e.ARROW_DOWN=9]="ARROW_DOWN",e[e.ARROW_LEFT=10]="ARROW_LEFT",e[e.FOUR_STAR=11]="FOUR_STAR"}(s||(s={})),function(e){e[e.SOLID=0]="SOLID",e[e.DOTTED=1]="DOTTED"}(i||(i={})),function(e){e[e.THIN=0]="THIN",e[e.MIDDLE=1]="MIDDLE",e[e.BOLD=2]="BOLD",e[e.MAXBOLD=3]="MAXBOLD"}(n||(n={})),function(e){e[e.MAIN=0]="MAIN",e[e.SUB=1]="SUB"}(o||(o={}));var d=a(13),f=a(20),m=function(){function e(t){Object(d.a)(this,e),this.eventName=void 0,this.callbacks=void 0,this.eventName=t,this.callbacks=[]}return Object(f.a)(e,[{key:"registerCallback",value:function(e){this.callbacks.push(e)}},{key:"unregisterCallback",value:function(e){var t=this.callbacks.indexOf(e);t>-1&&this.callbacks.splice(t,1)}},{key:"fire",value:function(e){this.callbacks.slice(0).forEach((function(t){t(e)}))}}]),e}(),y=function(){function e(){Object(d.a)(this,e),this.events=void 0,this.events={}}return Object(f.a)(e,[{key:"dispatch",value:function(e,t){var a=this.events[e];a&&a.fire(t)}},{key:"on",value:function(e,t){var a=this.events[e];a||(a=new m(e),this.events[e]=a),a.registerCallback(t)}},{key:"off",value:function(e,t){var a=this.events[e];a&&a.callbacks.indexOf(t)>-1&&(a.unregisterCallback(t),0===a.callbacks.length&&delete this.events[e])}}]),e}(),g=Object(l.createContext)({type:c.PEN,setType:function(e){}}),C=Object(l.createContext)({type:s.LINE,setType:function(e){}}),N=Object(l.createContext)({type:i.SOLID,setType:function(e){}}),R=Object(l.createContext)({type:n.THIN,setType:function(e){}}),k=Object(l.createContext)({mainColor:"black",subColor:"white",activeColor:o.MAIN,setColor:function(e){},setActiveColor:function(e){}}),D=Object(l.createContext)({dispatcher:new y}),E=(a(99),a(3)),T="selected-tool",I=function(e){var t=e.className;return Object(E.jsxs)("div",{className:t?"toolpanel ".concat(t):"toolpanel",children:[Object(E.jsx)(g.Consumer,{children:function(e){var t=e.type,a=e.setType;return Object(E.jsxs)(E.Fragment,{children:[Object(E.jsxs)("div",{className:"top",children:[Object(E.jsx)("span",{title:"\u94c5\u7b14",children:Object(E.jsx)(p.a,{className:t===c.PEN?"tool-item ".concat(T):"tool-item",onClick:function(){a(c.PEN)}})}),Object(E.jsx)("span",{title:"\u6a61\u76ae\u64e6",children:Object(E.jsx)("img",{src:"./icon/eraser.svg",className:t===c.ERASER?"tool-item ".concat(T):"tool-item",onClick:function(){a(c.ERASER)}})}),Object(E.jsx)("span",{title:"\u586b\u5145",children:Object(E.jsx)(j.a,{className:t===c.COLOR_FILL?"tool-item ".concat(T):"tool-item",onClick:function(){a(c.COLOR_FILL)}})})]}),Object(E.jsx)("div",{className:"down",children:Object(E.jsx)("span",{title:"\u989c\u8272\u9009\u53d6\u5668",children:Object(E.jsx)(x.a,{className:t===c.COLOR_EXTRACT?"tool-item ".concat(T):"tool-item",onClick:function(){a(c.COLOR_EXTRACT)}})})})]})}}),Object(E.jsx)("div",{className:"title",children:"\u5de5\u5177"})]})},L=a(168),A=a(161),w=a(154),S=a(166),M=(a(106),[{type:s.LINE,img:"./icon/shape_line.svg",title:"\u76f4\u7ebf"},{type:s.RECT,img:"./icon/shape_rect.svg",title:"\u77e9\u5f62"},{type:s.CIRCLE,img:"./icon/shape_circle.svg",title:"\u5706\uff08\u692d\u5706\uff09"},{type:s.RHOMBUS,img:"./icon/shape_rhombus.svg",title:"\u83f1\u5f62"},{type:s.TRIANGLE,img:"./icon/shape_triangle.svg",title:"\u4e09\u89d2\u5f62"},{type:s.PENTAGON,img:"./icon/shape_pentagon.svg",title:"\u4e94\u8fb9\u5f62"},{type:s.SEXANGLE,img:"./icon/shape_sexangle.svg",title:"\u516d\u8fb9\u5f62"},{type:s.ARROW_TOP,img:"./icon/shape_arrowtop.svg",title:"\u4e0a\u7bad\u5934"},{type:s.ARROW_RIGHT,img:"./icon/shape_arrowright.svg",title:"\u53f3\u7bad\u5934"},{type:s.ARROW_DOWN,img:"./icon/shape_arrowdown.svg",title:"\u4e0b\u7bad\u5934"},{type:s.ARROW_LEFT,img:"./icon/shape_arrowleft.svg",title:"\u5de6\u7bad\u5934"},{type:s.FOUR_STAR,img:"./icon/shape_fourstar.svg",title:"\u56db\u89d2\u661f"}]),P=function(e){var t=e.className,a=Object(l.useContext)(g),s=Object(l.useContext)(N);return Object(E.jsxs)("div",{className:t?"shapepanel ".concat(t):"shapepanel",children:[Object(E.jsxs)("div",{className:"shape-container",children:[Object(E.jsx)("div",{className:"shape-content",children:Object(E.jsx)(C.Consumer,{children:function(e){var t=e.type,s=e.setType;return M.map((function(e){return Object(E.jsx)("img",{src:e.img,title:e.title,className:t===e.type&&a.type===c.SHAPE?"shape-item ".concat("selected-shape"):"shape-item",onClick:function(){return s(e.type)}},e.img)}))}})}),Object(E.jsx)("div",{className:"shape-style",children:Object(E.jsxs)(w.a,{variant:"outlined",disabled:a.type!==c.SHAPE,children:[Object(E.jsx)(S.a,{children:"\u8f6e\u5ed3"}),Object(E.jsxs)(A.a,{value:s.type,onChange:function(e){return s.setType(e.target.value)},label:"\u8f6e\u5ed3",children:[Object(E.jsx)(L.a,{value:i.SOLID,children:"\u5b9e\u7ebf"}),Object(E.jsx)(L.a,{value:i.DOTTED,children:"\u865a\u7ebf"})]})]})})]}),Object(E.jsx)("div",{className:"title",children:"\u5f62\u72b6"})]})},_=a(159),W=a(162),B=(a(108),[{type:n.THIN,img:"./icon/thickline1.svg",title:"1px"},{type:n.MIDDLE,img:"./icon/thickline2.svg",title:"2px"},{type:n.BOLD,img:"./icon/thickline3.svg",title:"3px"},{type:n.MAXBOLD,img:"./icon/thickline4.svg",title:"4px"}]),F=function(e){var t=e.className,a=Object(l.useState)(!1),c=Object(h.a)(a,2),s=c[0],i=c[1],n=Object(l.useState)(),o=Object(h.a)(n,2),r=o[0],u=o[1],v=Object(l.useContext)(R);return Object(E.jsxs)("div",{className:t?"thickselector ".concat(t):"thickselector",children:[Object(E.jsx)("img",{className:"thickline",src:"./icon/thickness.svg",onClick:function(e){u(e.currentTarget),i(!0)}}),Object(E.jsx)(W.a,{open:s,onClose:function(){i(!1)},anchorEl:r,anchorOrigin:{vertical:"bottom",horizontal:"left"},children:B.map((function(e){return Object(E.jsx)("img",{className:e.type===v.type?"thick-item ".concat("selected-item"):"thick-item",src:e.img,title:e.title,onClick:function(){v.setType(e.type),i(!1)}},e.img)}))}),Object(E.jsx)("div",{className:"title",children:"\u7c97\u7ec6"})]})},H=a(61),G=(a(110),[{title:"\u9ed1\u8272",value:"#000000"},{title:"\u7070\u8272-50%",value:"#7f7f7f"},{title:"\u6df1\u7ea2\u8272",value:"#880015"},{title:"\u7ea2\u8272",value:"#ed1c24"},{title:"\u6a59\u8272",value:"#ff7f27"},{title:"\u9ec4\u8272",value:"#fff200"},{title:"\u7eff\u8272",value:"#22b14c"},{title:"\u9752\u7eff\u8272",value:"#00a2e8"},{title:"\u84dd\u9752\u8272",value:"#3f48cc"},{title:"\u7d2b\u8272",value:"#a349a4"},{title:"\u767d\u8272",value:"#ffffff"},{title:"\u7070\u8272-25%",value:"#c3c3c3"},{title:"\u8910\u8272",value:"#b97a57"},{title:"\u73ab\u7470\u8272",value:"#ffaec9"},{title:"\u91d1\u8272",value:"#ffc90e"},{title:"\u6d45\u9ec4\u8272",value:"#efe4b0"},{title:"\u9178\u6a59\u8272",value:"#b5e61d"},{title:"\u9752\u7eff\u8272",value:"#808000"},{title:"\u6de1\u9752\u84dd\u8272",value:"#99d9ea"},{title:"\u84dd\u7070\u8272",value:"#7092be"},{title:"\u6de1\u7d2b\u8272",value:"#c8bfe7"}]),U="active-color-type",X=function(e){var t=e.className,a=Object(l.useState)(Object(H.b)("black")),c=Object(h.a)(a,2),s=c[0],i=c[1],n=Object(l.useContext)(k),r=n.activeColor;return Object(l.useEffect)((function(){n.setColor("#".concat(s.hex))}),[s]),Object(E.jsxs)("div",{className:t?"colorpanel ".concat(t):"colorpanel",children:[Object(E.jsxs)("div",{className:"content",children:[Object(E.jsxs)("div",{className:"color-result",children:[Object(E.jsxs)("div",{onClick:function(){return n.setActiveColor(o.MAIN)},className:r===o.MAIN?"main-color ".concat(U):"main-color",children:[Object(E.jsx)("div",{className:"color-box1",style:{backgroundColor:n.mainColor}}),Object(E.jsx)("div",{children:"\u989c\u82721"})]}),Object(E.jsxs)("div",{onClick:function(){return n.setActiveColor(o.SUB)},className:r===o.SUB?"sub-color ".concat(U):"sub-color",children:[Object(E.jsx)("div",{className:"color-box2",style:{backgroundColor:n.subColor}}),Object(E.jsx)("div",{children:"\u989c\u82722"})]})]}),Object(E.jsx)("div",{className:"color-template",children:G.map((function(e){return Object(E.jsx)("div",{onClick:function(){return n.setColor(e.value)},className:"color-template-item",style:{backgroundColor:e.value}},e.value)}))}),Object(E.jsxs)("div",{className:"color-picker",children:[Object(E.jsx)(H.a,{value:s,hideTextfield:!0,onChange:function(e){return i(e)}}),Object(E.jsx)("div",{className:"color-picker-title",children:"\u7f16\u8f91\u989c\u8272"})]})]}),Object(E.jsx)("div",{className:"title",children:"\u989c\u8272"})]})},J=a(75),Y=a.n(J),q=a(76),z=a.n(q),K=a(77),Q=a.n(K),V=(a(111),"clear"),Z="redo",$="undo",ee=function(){var e=Object(l.useContext)(D);return Object(E.jsxs)("div",{className:"otherOperator",children:[Object(E.jsxs)("div",{className:"operator-content",children:[Object(E.jsx)("span",{title:"\u6e05\u7a7a\u753b\u5e03",className:"operator-item",children:Object(E.jsx)(Y.a,{onClick:function(){e.dispatcher.dispatch(V)}})}),Object(E.jsx)("span",{title:"\u540e\u9000",className:"operator-item",children:Object(E.jsx)(z.a,{onClick:function(){e.dispatcher.dispatch($)}})}),Object(E.jsx)("span",{title:"\u524d\u8fdb",className:"operator-item",children:Object(E.jsx)(Q.a,{onClick:function(){e.dispatcher.dispatch(Z)}})})]}),Object(E.jsx)("span",{className:"title",children:"\u5176\u4ed6"})]})},te=function(){return Object(E.jsxs)("div",{className:"toolbar",children:[Object(E.jsx)(I,{className:"toolbar-item"}),Object(E.jsx)(_.a,{className:"divider",orientation:"vertical",flexItem:!0}),Object(E.jsx)(P,{className:"toolbar-item"}),Object(E.jsx)(_.a,{className:"divider",orientation:"vertical",flexItem:!0}),Object(E.jsx)(F,{className:"toolbar-item"}),Object(E.jsx)(_.a,{className:"divider",orientation:"vertical",flexItem:!0}),Object(E.jsx)(X,{className:"toolbar-item"}),Object(E.jsx)(_.a,{className:"divider",orientation:"vertical",flexItem:!0}),Object(E.jsx)(ee,{}),Object(E.jsx)(_.a,{className:"divider",orientation:"vertical",flexItem:!0})]})},ae=a(158),ce=(a(112),a(19)),se=a(18),ie=function(e,t){var a=e.getBoundingClientRect();return{x:t.clientX-a.left,y:t.clientY-a.top}},ne=function(){function e(){Object(d.a)(this,e)}return Object(f.a)(e,[{key:"onMouseDown",value:function(e){}},{key:"onMouseMove",value:function(e){}},{key:"onMouseUp",value:function(e){}}]),e}();ne.lineWidthFactor=1,ne.mainColor="black",ne.subColor="white",ne.ctx=void 0;var oe=function(e){Object(ce.a)(a,e);var t=Object(se.a)(a);function a(){var e;Object(d.a)(this,a);for(var c=arguments.length,s=new Array(c),i=0;i<c;i++)s[i]=arguments[i];return(e=t.call.apply(t,[this].concat(s))).lineWidthBase=1,e.drawColorType=o.MAIN,e.mouseDown=!1,e.previousPos={x:0,y:0},e}return Object(f.a)(a,[{key:"onMouseDown",value:function(e){if(ne.ctx){this.mouseDown=!0;var t=ie(ne.ctx.canvas,e);ne.ctx.lineWidth=ne.lineWidthFactor*this.lineWidthBase,ne.ctx.strokeStyle=this.drawColorType===o.MAIN?ne.mainColor:ne.subColor,ne.ctx.lineJoin="round",ne.ctx.lineCap="round",ne.ctx.beginPath(),this.previousPos=t}}},{key:"onMouseUp",value:function(){this.mouseDown&&(ne.ctx.closePath(),this.mouseDown=!1)}},{key:"onMouseMove",value:function(e){if(this.mouseDown){var t=ie(ne.ctx.canvas,e);ne.ctx.moveTo(this.previousPos.x,this.previousPos.y);var a=.5*(this.previousPos.x+t.x),c=.5*(this.previousPos.y+t.y);ne.ctx.quadraticCurveTo(a,c,t.x,t.y),ne.ctx.stroke(),this.previousPos=t}}}]),a}(ne),le=oe,re=function(e){Object(ce.a)(a,e);var t=Object(se.a)(a);function a(){var e;Object(d.a)(this,a);for(var c=arguments.length,s=new Array(c),i=0;i<c;i++)s[i]=arguments[i];return(e=t.call.apply(t,[this].concat(s))).lineWidthBase=3,e.drawColorType=o.SUB,e}return a}(le),ue=re,he=function(e){Object(ce.a)(a,e);var t=Object(se.a)(a);function a(e){var c;return Object(d.a)(this,a),(c=t.call(this)).setColor=void 0,c.setColor=e,c}return Object(f.a)(a,[{key:"onMouseDown",value:function(e){var t=ie(ne.ctx.canvas,e),a=function(e,t,a){var c=e.getImageData(t,a,1,1).data;return"#"+("000000"+function(e,t,a){if(e>255||t>255||a>255)throw"Invalid color component";return(e<<16|t<<8|a).toString(16)}(c[0],c[1],c[2])).slice(-6)}(ne.ctx,t.x,t.y);this.setColor(a)}}]),a}(ne),ve=a(78),pe=a.n(ve),Oe=function(e,t,a){var c=e.data[t],s=e.data[t+1],i=e.data[t+2];return c===a[0]&&s===a[1]&&i===a[2]},je=function(e,t,a){return e.data[t]=a[0],e.data[t+1]=a[1],e.data[t+2]=a[2],e},be=function(e){Object(ce.a)(a,e);var t=Object(se.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(f.a)(a,[{key:"onMouseDown",value:function(e){var t=ie(ne.ctx.canvas,e),a=new pe.a(ne.mainColor);!function(e,t,a,c){var s=[[t,a]],i=e.canvas.width,n=e.canvas.height,o=4*(a*i+t),l=e.getImageData(0,0,i,n),r=[l.data[o],l.data[o+1],l.data[o+2]];if(r[0]!==c[0]||r[1]!==c[1]||r[2]!==c[2]){for(;s.length>0;){for(var u=s.pop(),h=u[0],v=u[1],p=4*(v*i+h);v-- >=0&&Oe(l,p,r);)p-=4*i;p+=4*i,++v;for(var O=!1,j=!1;v++<n-1&&Oe(l,p,r);)je(l,p,c),h>0&&(Oe(l,p-4,r)?O||(s.push([h-1,v]),O=!0):O&&(O=!1)),h<i-1&&(Oe(l,p+4,r)?j||(s.push([h+1,v]),j=!0):j&&(j=!1)),p+=4*i}e.putImageData(l,0,0)}}(ne.ctx,t.x,t.y,[a.red(),a.green(),a.blue()])}}]),a}(ne),xe=be,de=function(e){Object(ce.a)(a,e);var t=Object(se.a)(a);function a(e){var c,s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Object(d.a)(this,a),(c=t.call(this)).type=void 0,c.saveImageData=void 0,c.isMouseDown=!1,c.mouseDownPos={x:0,y:0},c.lineWidthBase=1,c.isDashed=!1,c.dashLineStyle=[10,10],c.type=e,c.isDashed=s,c}return Object(f.a)(a,[{key:"setType",value:function(e){this.type=e}},{key:"onMouseDown",value:function(e){var t=ie(ne.ctx.canvas,e);this.saveImageData=ne.ctx.getImageData(0,0,ne.ctx.canvas.width,ne.ctx.canvas.height),this.isMouseDown=!0,this.mouseDownPos=t}},{key:"onMouseMove",value:function(e){if(this.isMouseDown&&this.saveImageData){var t=ne.ctx;t.clearRect(0,0,ne.ctx.canvas.width,ne.ctx.canvas.height),t.putImageData(this.saveImageData,0,0);var a=ie(ne.ctx.canvas,e),c=function(e,t,a,c,i){var n=[],o=.5*(t+c),l=.5*(a+i);switch(e){case s.LINE:n.push({x:t,y:a}),n.push({x:c,y:i});break;case s.RECT:n.push({x:t,y:a}),n.push({x:c,y:a}),n.push({x:c,y:i}),n.push({x:t,y:i});break;case s.CIRCLE:n.push({x:.5*(t+c),y:.5*(a+i)});break;case s.RHOMBUS:n.push({x:o,y:a}),n.push({x:c,y:l}),n.push({x:o,y:i}),n.push({x:t,y:l});break;case s.TRIANGLE:n.push({x:o,y:a}),n.push({x:t,y:i}),n.push({x:c,y:i});break;case s.PENTAGON:n.push({x:o,y:a}),n.push({x:c,y:l}),n.push({x:.5*(o+c),y:i}),n.push({x:.5*(o+t),y:i}),n.push({x:t,y:l});break;case s.SEXANGLE:n.push({x:o,y:a}),n.push({x:c,y:.5*(a+l)}),n.push({x:c,y:.5*(i+l)}),n.push({x:o,y:i}),n.push({x:t,y:.5*(i+l)}),n.push({x:t,y:.5*(a+l)});break;case s.ARROW_TOP:n.push({x:o,y:a}),n.push({x:c,y:l}),n.push({x:c-1/3*(c-t),y:l}),n.push({x:c-1/3*(c-t),y:i}),n.push({x:t+1/3*(c-t),y:i}),n.push({x:t+1/3*(c-t),y:l}),n.push({x:t,y:l});break;case s.ARROW_RIGHT:n.push({x:c,y:l}),n.push({x:o,y:i}),n.push({x:o,y:i-1/3*(i-a)}),n.push({x:t,y:i-1/3*(i-a)}),n.push({x:t,y:a+1/3*(i-a)}),n.push({x:o,y:a+1/3*(i-a)}),n.push({x:o,y:a});break;case s.ARROW_DOWN:n.push({x:o,y:i}),n.push({x:t,y:l}),n.push({x:t+1/3*(c-t),y:l}),n.push({x:t+1/3*(c-t),y:a}),n.push({x:c-1/3*(c-t),y:a}),n.push({x:c-1/3*(c-t),y:l}),n.push({x:c,y:l});break;case s.ARROW_LEFT:n.push({x:t,y:l}),n.push({x:o,y:a}),n.push({x:o,y:a+1/3*(i-a)}),n.push({x:c,y:a+1/3*(i-a)}),n.push({x:c,y:i-1/3*(i-a)}),n.push({x:o,y:i-1/3*(i-a)}),n.push({x:o,y:i});break;case s.FOUR_STAR:var r=.125*(c-t),u=.125*(i-a);n.push({x:o,y:a}),n.push({x:o+r,y:l-u}),n.push({x:c,y:l}),n.push({x:o+r,y:l+u}),n.push({x:o,y:i}),n.push({x:o-r,y:l+u}),n.push({x:t,y:l}),n.push({x:o-r,y:l-u})}return n}(this.type,this.mouseDownPos.x,this.mouseDownPos.y,a.x,a.y);if(t.strokeStyle=ne.mainColor,t.lineWidth=ne.lineWidthFactor*this.lineWidthBase,t.fillStyle=ne.subColor,this.isDashed&&t.setLineDash(this.dashLineStyle),this.type===s.CIRCLE)t.beginPath(),t.ellipse(c[0].x,c[0].y,Math.abs(.5*(a.x-this.mouseDownPos.x)),Math.abs(.5*(a.y-this.mouseDownPos.y)),0,0,2*Math.PI),t.stroke();else{t.beginPath(),t.moveTo(c[0].x,c[0].y);for(var i=1;i<c.length;i++)t.lineTo(c[i].x,c[i].y);t.closePath(),t.stroke()}t.setLineDash([])}}},{key:"onMouseUp",value:function(){this.isMouseDown=!1,this.saveImageData=void 0}}]),a}(ne),fe=de,me=function(){function e(){Object(d.a)(this,e),this.imageData1=[],this.imageData2=[]}return Object(f.a)(e,[{key:"add",value:function(e){this.imageData1.push(e)}},{key:"back",value:function(){if(this.imageData1.length>1){var e=this.imageData1.pop();this.imageData2.push(e)}return this.imageData1.length>0?this.imageData1[this.imageData1.length-1]:null}},{key:"forward",value:function(){if(this.imageData2.length>0){var e=this.imageData2.pop();this.imageData1.push(e)}return this.imageData1.length>0?this.imageData1[this.imageData1.length-1]:null}}]),e}(),ye=function(e){var t=e.toolType,a=e.lineWidthType,s=e.mainColor,o=e.subColor,r=e.setColor,u=e.shapeType,v=e.shapeOutlineType,p=Object(l.useState)(),O=Object(h.a)(p,2),j=O[0],b=O[1],x=Object(l.useRef)(null),d=Object(l.useContext)(D),f=Object(l.useState)(new me),m=Object(h.a)(f,1)[0];Object(l.useEffect)((function(){switch(t){case c.PEN:b(new le);break;case c.ERASER:b(new ue);break;case c.COLOR_EXTRACT:b(new he(r));break;case c.COLOR_FILL:b(new xe);break;case c.SHAPE:b(new fe(u,v===i.DOTTED))}}),[t,u]),Object(l.useEffect)((function(){j instanceof fe&&(j.isDashed=v===i.DOTTED)}),[v]),Object(l.useEffect)((function(){switch(a){case n.THIN:ne.lineWidthFactor=1;break;case n.MIDDLE:ne.lineWidthFactor=2;break;case n.BOLD:ne.lineWidthFactor=3;break;case n.MAXBOLD:ne.lineWidthFactor=4}}),[a]),Object(l.useEffect)((function(){ne.mainColor=s}),[s]),Object(l.useEffect)((function(){ne.subColor=o}),[o]),Object(l.useEffect)((function(){var e=x.current;if(e){e.style.width="100%",e.style.height="100%",e.height=e.clientHeight,e.width=e.clientWidth,ne.ctx=e.getContext("2d");var t=e.getContext("2d");t&&(t.fillStyle="white",t.fillRect(0,0,e.width,e.height),m.add(t.getImageData(0,0,e.width,e.height)));var a=d.dispatcher,c=function(){var t=e.getContext("2d");t&&(t.fillStyle="white",t.fillRect(0,0,e.width,e.height))};a.on(V,c);a.on(Z,(function(){var t=e.getContext("2d");if(t){var a=m.forward();a&&(t.clearRect(0,0,e.width,e.height),t.putImageData(a,0,0))}}));return a.on($,(function(){var t=e.getContext("2d");if(t){var a=m.back();a&&(t.clearRect(0,0,e.width,e.height),t.putImageData(a,0,0))}})),function(){a.off(V,c)}}}),[x]);var y=function(e){j&&j.onMouseDown(e)},g=function(e){j&&j.onMouseMove(e)},C=function(e){j&&(j.onMouseUp(e),m.add(ne.ctx.getImageData(0,0,ne.ctx.canvas.width,ne.ctx.canvas.height)))};return Object(l.useEffect)((function(){var e=x.current;if(e)return e.addEventListener("mousedown",y),e.addEventListener("mousemove",g),e.addEventListener("mouseup",C),function(){e.removeEventListener("mousedown",y),e.removeEventListener("mousemove",g),e.removeEventListener("mouseup",C)}}),[x,y,g,C]),Object(E.jsx)("div",{className:"canvas",children:Object(E.jsx)(ae.a,{className:"paper",children:Object(E.jsx)("canvas",{ref:x})})})};a(120);var ge=function(){var e=Object(l.useState)(c.PEN),t=Object(h.a)(e,2),a=t[0],r=t[1],u=Object(l.useState)(s.LINE),v=Object(h.a)(u,2),p=v[0],O=v[1],j=Object(l.useState)(i.SOLID),b=Object(h.a)(j,2),x=b[0],d=b[1],f=Object(l.useState)(n.THIN),m=Object(h.a)(f,2),T=m[0],I=m[1],L=Object(l.useState)(o.MAIN),A=Object(h.a)(L,2),w=A[0],S=A[1],M=Object(l.useState)("black"),P=Object(h.a)(M,2),_=P[0],W=P[1],B=Object(l.useState)("white"),F=Object(h.a)(B,2),H=F[0],G=F[1],U=Object(l.useState)(new y),X=Object(h.a)(U,1)[0],J=function(e){w===o.MAIN?W(e):G(e)};return Object(E.jsx)(g.Provider,{value:{type:a,setType:r},children:Object(E.jsx)(C.Provider,{value:{type:p,setType:function(e){r(c.SHAPE),O(e)}},children:Object(E.jsx)(N.Provider,{value:{type:x,setType:d},children:Object(E.jsx)(R.Provider,{value:{type:T,setType:I},children:Object(E.jsx)(D.Provider,{value:{dispatcher:X},children:Object(E.jsx)(k.Provider,{value:{mainColor:_,subColor:H,activeColor:w,setColor:J,setActiveColor:S},children:Object(E.jsxs)("div",{className:"app",children:[Object(E.jsx)(te,{}),Object(E.jsx)(ye,{toolType:a,shapeType:p,shapeOutlineType:x,mainColor:_,subColor:H,lineWidthType:T,setColor:J})]})})})})})})})};u.a.render(Object(E.jsx)(ge,{}),document.getElementById("root"))},98:function(e,t,a){},99:function(e,t,a){}},[[121,1,2]]]);
//# sourceMappingURL=main.2784ef78.chunk.js.map